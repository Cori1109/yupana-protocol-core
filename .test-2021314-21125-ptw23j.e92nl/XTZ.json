{
  "contractName": "XTZ",
  "abi": [],
  "michelson": "[ { \"prim\": \"parameter\",\n    \"args\":\n      [ { \"prim\": \"or\",\n          \"args\":\n            [ { \"prim\": \"or\",\n                \"args\":\n                  [ { \"prim\": \"or\",\n                      \"args\":\n                        [ { \"prim\": \"pair\",\n                            \"args\":\n                              [ { \"prim\": \"address\",\n                                  \"annots\": [ \"%spender\" ] },\n                                { \"prim\": \"nat\", \"annots\": [ \"%value\" ] } ],\n                            \"annots\": [ \"%approve\" ] },\n                          { \"prim\": \"pair\",\n                            \"args\":\n                              [ { \"prim\": \"pair\",\n                                  \"args\":\n                                    [ { \"prim\": \"address\",\n                                        \"annots\": [ \"%owner\" ] },\n                                      { \"prim\": \"address\",\n                                        \"annots\": [ \"%spender\" ] } ] },\n                                { \"prim\": \"contract\",\n                                  \"args\": [ { \"prim\": \"nat\" } ] } ],\n                            \"annots\": [ \"%getAllowance\" ] } ] },\n                    { \"prim\": \"or\",\n                      \"args\":\n                        [ { \"prim\": \"pair\",\n                            \"args\":\n                              [ { \"prim\": \"address\", \"annots\": [ \"%owner\" ] },\n                                { \"prim\": \"contract\",\n                                  \"args\": [ { \"prim\": \"nat\" } ] } ],\n                            \"annots\": [ \"%getBalance\" ] },\n                          { \"prim\": \"pair\",\n                            \"args\":\n                              [ { \"prim\": \"unit\" },\n                                { \"prim\": \"contract\",\n                                  \"args\": [ { \"prim\": \"nat\" } ] } ],\n                            \"annots\": [ \"%getTotalSupply\" ] } ] } ] },\n              { \"prim\": \"or\",\n                \"args\":\n                  [ { \"prim\": \"or\",\n                      \"args\":\n                        [ { \"prim\": \"unit\", \"annots\": [ \"%mint\" ] },\n                          { \"prim\": \"pair\",\n                            \"args\":\n                              [ { \"prim\": \"address\", \"annots\": [ \"%from\" ] },\n                                { \"prim\": \"pair\",\n                                  \"args\":\n                                    [ { \"prim\": \"address\",\n                                        \"annots\": [ \"%to\" ] },\n                                      { \"prim\": \"nat\",\n                                        \"annots\": [ \"%value\" ] } ] } ],\n                            \"annots\": [ \"%transfer\" ] } ] },\n                    { \"prim\": \"pair\",\n                      \"args\": [ { \"prim\": \"nat\" }, { \"prim\": \"unit\" } ],\n                      \"annots\": [ \"%withdraw\" ] } ] } ] } ] },\n  { \"prim\": \"storage\",\n    \"args\":\n      [ { \"prim\": \"pair\",\n          \"args\":\n            [ { \"prim\": \"big_map\",\n                \"args\":\n                  [ { \"prim\": \"address\" },\n                    { \"prim\": \"pair\",\n                      \"args\":\n                        [ { \"prim\": \"map\",\n                            \"args\":\n                              [ { \"prim\": \"address\" }, { \"prim\": \"nat\" } ],\n                            \"annots\": [ \"%allowances\" ] },\n                          { \"prim\": \"nat\", \"annots\": [ \"%balance\" ] } ] } ],\n                \"annots\": [ \"%ledger\" ] },\n              { \"prim\": \"nat\", \"annots\": [ \"%totalSupply\" ] } ] } ] },\n  { \"prim\": \"code\",\n    \"args\":\n      [ [ { \"prim\": \"NIL\", \"args\": [ { \"prim\": \"operation\" } ] },\n          { \"prim\": \"LAMBDA\",\n            \"args\":\n              [ { \"prim\": \"pair\",\n                  \"args\":\n                    [ { \"prim\": \"address\" },\n                      { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"big_map\",\n                              \"args\":\n                                [ { \"prim\": \"address\" },\n                                  { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"map\",\n                                          \"args\":\n                                            [ { \"prim\": \"address\" },\n                                              { \"prim\": \"nat\" } ] },\n                                        { \"prim\": \"nat\" } ] } ] },\n                            { \"prim\": \"nat\" } ] } ] },\n                { \"prim\": \"pair\",\n                  \"args\":\n                    [ { \"prim\": \"map\",\n                        \"args\": [ { \"prim\": \"address\" }, { \"prim\": \"nat\" } ] },\n                      { \"prim\": \"nat\" } ] },\n                [ { \"prim\": \"UNPAIR\" }, { \"prim\": \"SWAP\" },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"SWAP\" }, { \"prim\": \"GET\" },\n                  { \"prim\": \"IF_NONE\",\n                    \"args\":\n                      [ [ { \"prim\": \"PUSH\",\n                            \"args\": [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] },\n                          { \"prim\": \"EMPTY_MAP\",\n                            \"args\":\n                              [ { \"prim\": \"address\" }, { \"prim\": \"nat\" } ] },\n                          { \"prim\": \"PAIR\" } ], [] ] } ] ] },\n          { \"prim\": \"LAMBDA\",\n            \"args\":\n              [ { \"prim\": \"pair\",\n                  \"args\":\n                    [ { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"pair\",\n                              \"args\":\n                                [ { \"prim\": \"map\",\n                                    \"args\":\n                                      [ { \"prim\": \"address\" },\n                                        { \"prim\": \"nat\" } ] },\n                                  { \"prim\": \"nat\" } ] },\n                            { \"prim\": \"address\" } ] },\n                      { \"prim\": \"pair\",\n                        \"args\":\n                          [ { \"prim\": \"big_map\",\n                              \"args\":\n                                [ { \"prim\": \"address\" },\n                                  { \"prim\": \"pair\",\n                                    \"args\":\n                                      [ { \"prim\": \"map\",\n                                          \"args\":\n                                            [ { \"prim\": \"address\" },\n                                              { \"prim\": \"nat\" } ] },\n                                        { \"prim\": \"nat\" } ] } ] },\n                            { \"prim\": \"nat\" } ] } ] }, { \"prim\": \"nat\" },\n                [ { \"prim\": \"UNPAIR\" }, { \"prim\": \"SWAP\" },\n                  { \"prim\": \"DROP\" }, { \"prim\": \"UNPAIR\" },\n                  { \"prim\": \"CAR\" }, { \"prim\": \"SWAP\" }, { \"prim\": \"GET\" },\n                  { \"prim\": \"IF_NONE\",\n                    \"args\":\n                      [ [ { \"prim\": \"PUSH\",\n                            \"args\": [ { \"prim\": \"nat\" }, { \"int\": \"0\" } ] } ],\n                        [] ] } ] ] },\n          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] },\n          { \"prim\": \"UNPAIR\" },\n          { \"prim\": \"IF_LEFT\",\n            \"args\":\n              [ [ { \"prim\": \"IF_LEFT\",\n                    \"args\":\n                      [ [ { \"prim\": \"IF_LEFT\",\n                            \"args\":\n                              [ [ { \"prim\": \"UNPAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DROP\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"SOME\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"UPDATE\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SOME\" },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"UPDATE\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"PAIR\" } ],\n                                [ { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DROP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"UNPAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"NIL\",\n                                    \"args\": [ { \"prim\": \"operation\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"mutez\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"TRANSFER_TOKENS\" },\n                                  { \"prim\": \"CONS\" }, { \"prim\": \"PAIR\" } ] ] } ],\n                        [ { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"DROP\" },\n                          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] },\n                          { \"prim\": \"DROP\" },\n                          { \"prim\": \"IF_LEFT\",\n                            \"args\":\n                              [ [ { \"prim\": \"UNPAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"NIL\",\n                                    \"args\": [ { \"prim\": \"operation\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"mutez\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"TRANSFER_TOKENS\" },\n                                  { \"prim\": \"CONS\" }, { \"prim\": \"PAIR\" } ],\n                                [ { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DROP\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"NIL\",\n                                    \"args\": [ { \"prim\": \"operation\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"mutez\" }, { \"int\": \"0\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"TRANSFER_TOKENS\" },\n                                  { \"prim\": \"CONS\" }, { \"prim\": \"PAIR\" } ] ] } ] ] } ],\n                [ { \"prim\": \"IF_LEFT\",\n                    \"args\":\n                      [ [ { \"prim\": \"IF_LEFT\",\n                            \"args\":\n                              [ [ { \"prim\": \"DROP\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DROP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"mutez\" }, { \"int\": \"1\" } ] },\n                                  { \"prim\": \"AMOUNT\" }, { \"prim\": \"EDIV\" },\n                                  { \"prim\": \"IF_NONE\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"PUSH\",\n                                            \"args\":\n                                              [ { \"prim\": \"string\" },\n                                                { \"string\": \"DIV by 0\" } ] },\n                                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"ADD\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SOME\" }, { \"prim\": \"SENDER\" },\n                                  { \"prim\": \"UPDATE\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"PAIR\" } ],\n                                [ { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CDR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"UNPAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"6\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"7\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"COMPARE\" },\n                                  { \"prim\": \"LT\" },\n                                  { \"prim\": \"IF\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"PUSH\",\n                                            \"args\":\n                                              [ { \"prim\": \"string\" },\n                                                { \"string\":\n                                                    \"NotEnoughBalance\" } ] },\n                                          { \"prim\": \"FAILWITH\" } ], [] ] },\n                                  { \"prim\": \"SENDER\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"5\" } ] },\n                                  { \"prim\": \"COMPARE\" }, { \"prim\": \"NEQ\" },\n                                  { \"prim\": \"IF\",\n                                    \"args\":\n                                      [ [ { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"3\" } ] },\n                                          { \"prim\": \"SENDER\" },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"3\" } ] },\n                                          { \"prim\": \"PAIR\" },\n                                          { \"prim\": \"PAIR\" },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"6\" } ] },\n                                          { \"prim\": \"SWAP\" },\n                                          { \"prim\": \"EXEC\" },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"3\" } ] },\n                                          { \"prim\": \"SWAP\" },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"COMPARE\" },\n                                          { \"prim\": \"LT\" },\n                                          { \"prim\": \"IF\",\n                                            \"args\":\n                                              [ [ { \"prim\": \"PUSH\",\n                                                    \"args\":\n                                                      [ { \"prim\": \"string\" },\n                                                        { \"string\":\n                                                            \"NotEnoughAllowance\" } ] },\n                                                  { \"prim\": \"FAILWITH\" } ],\n                                                [] ] }, { \"prim\": \"SWAP\" },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"CDR\" },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"2\" } ] },\n                                          { \"prim\": \"CAR\" },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"3\" } ] },\n                                          { \"prim\": \"DUP\" },\n                                          { \"prim\": \"DUG\",\n                                            \"args\": [ { \"int\": \"4\" } ] },\n                                          { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"3\" } ] },\n                                          { \"prim\": \"SUB\" },\n                                          { \"prim\": \"ABS\" },\n                                          { \"prim\": \"SOME\" },\n                                          { \"prim\": \"SENDER\" },\n                                          { \"prim\": \"UPDATE\" },\n                                          { \"prim\": \"PAIR\" } ],\n                                        [ { \"prim\": \"DIG\",\n                                            \"args\": [ { \"int\": \"5\" } ] },\n                                          { \"prim\": \"DROP\" } ] ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"SUB\" },\n                                  { \"prim\": \"ABS\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"SOME\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"UPDATE\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"PAIR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"4\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" }, { \"prim\": \"ADD\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"CAR\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"DUP\" },\n                                  { \"prim\": \"DUG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CDR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"CAR\" },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"2\" } ] },\n                                  { \"prim\": \"DIG\",\n                                    \"args\": [ { \"int\": \"3\" } ] },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"SOME\" },\n                                  { \"prim\": \"SWAP\" }, { \"prim\": \"UPDATE\" },\n                                  { \"prim\": \"PAIR\" }, { \"prim\": \"SWAP\" },\n                                  { \"prim\": \"PAIR\" } ] ] } ],\n                        [ { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"DROP\" },\n                          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] },\n                          { \"prim\": \"DROP\" }, { \"prim\": \"CAR\" },\n                          { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                          { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"SENDER\" }, { \"prim\": \"PAIR\" },\n                          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] },\n                          { \"prim\": \"SWAP\" }, { \"prim\": \"EXEC\" },\n                          { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                          { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                          { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"CDR\" }, { \"prim\": \"COMPARE\" },\n                          { \"prim\": \"LT\" },\n                          { \"prim\": \"IF\",\n                            \"args\":\n                              [ [ { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"string\" },\n                                        { \"string\": \"NotEnoughBalance\" } ] },\n                                  { \"prim\": \"FAILWITH\" } ], [] ] },\n                          { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                          { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"SWAP\" }, { \"prim\": \"DUP\" },\n                          { \"prim\": \"DUG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"CDR\" }, { \"prim\": \"SUB\" },\n                          { \"prim\": \"ABS\" }, { \"prim\": \"SWAP\" },\n                          { \"prim\": \"CAR\" }, { \"prim\": \"PAIR\" },\n                          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"DUP\" },\n                          { \"prim\": \"DUG\", \"args\": [ { \"int\": \"3\" } ] },\n                          { \"prim\": \"CDR\" },\n                          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"3\" } ] },\n                          { \"prim\": \"CAR\" },\n                          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"2\" } ] },\n                          { \"prim\": \"SOME\" }, { \"prim\": \"SENDER\" },\n                          { \"prim\": \"UPDATE\" }, { \"prim\": \"PAIR\" },\n                          { \"prim\": \"NIL\",\n                            \"args\": [ { \"prim\": \"operation\" } ] },\n                          { \"prim\": \"SENDER\" },\n                          { \"prim\": \"CONTRACT\",\n                            \"args\": [ { \"prim\": \"unit\" } ] },\n                          { \"prim\": \"IF_NONE\",\n                            \"args\":\n                              [ [ { \"prim\": \"PUSH\",\n                                    \"args\":\n                                      [ { \"prim\": \"string\" },\n                                        { \"string\":\n                                            \"bad address for get_contract\" } ] },\n                                  { \"prim\": \"FAILWITH\" } ], [] ] },\n                          { \"prim\": \"PUSH\",\n                            \"args\": [ { \"prim\": \"mutez\" }, { \"int\": \"1\" } ] },\n                          { \"prim\": \"DIG\", \"args\": [ { \"int\": \"4\" } ] },\n                          { \"prim\": \"MUL\" }, { \"prim\": \"UNIT\" },\n                          { \"prim\": \"TRANSFER_TOKENS\" }, { \"prim\": \"CONS\" },\n                          { \"prim\": \"PAIR\" } ] ] } ] ] } ] ] } ]",
  "source": "#include \"../partials/IXTZ.ligo\"\n\n(* Helper function to get account *)\nfunction getAccount (const addr : address; const s : storage) : account is\n  block {\n    var acct : account :=\n      record [\n        balance    = 0n;\n        allowances = (map [] : map (address, amt));\n      ];\n    case s.ledger[addr] of\n      None -> skip\n    | Some(instance) -> acct := instance\n    end;\n  } with acct\n\n(* Helper function to get allowance for an account *)\nfunction getAllowance (const ownerAccount : account; const spender : address; const s : storage) : amt is\n  case ownerAccount.allowances[spender] of\n    Some (amt) -> amt\n  | None -> 0n\n  end;\n\n(* Transfer token to another account *)\nfunction transfer (const from_ : address; const to_ : address; const value : amt; var s : storage) : return is\n  block {\n\n    (* Retrieve sender account from storage *)\n    const senderAccount : account = getAccount(from_, s);\n\n    (* Balance check *)\n    if senderAccount.balance < value then\n      failwith(\"NotEnoughBalance\")\n    else skip;\n\n    (* Check this address can spend the tokens *)\n    if from_ =/= Tezos.sender then block {\n      const spenderAllowance : amt = getAllowance(senderAccount, Tezos.sender, s);\n\n      if spenderAllowance < value then\n        failwith(\"NotEnoughAllowance\")\n      else skip;\n\n      (* Decrease any allowances *)\n      senderAccount.allowances[Tezos.sender] := abs(spenderAllowance - value);\n    } else skip;\n\n    (* Update sender balance *)\n    senderAccount.balance := abs(senderAccount.balance - value);\n\n    (* Update storage *)\n    s.ledger[from_] := senderAccount;\n\n    (* Create or get destination account *)\n    var destAccount : account := getAccount(to_, s);\n\n    (* Update destination balance *)\n    destAccount.balance := destAccount.balance + value;\n\n    (* Update storage *)\n    s.ledger[to_] := destAccount;\n\n  } with (noOperations, s)\n\n(* Approve an amt to be spent by another address in the name of the sender *)\nfunction approve (const spender : address; const value : amt; var s : storage) : return is\n  block {\n\n    (* Create or get sender account *)\n    var senderAccount : account := getAccount(Tezos.sender, s);\n\n    (* Get current spender allowance *)\n    const spenderAllowance : amt = getAllowance(senderAccount, spender, s);\n\n    (* Prevent a corresponding attack vector *)\n    // if spenderAllowance > 0n and value > 0n then\n    //   failwith(\"UnsafeAllowanceChange\")\n    // else skip;\n\n    (* Set spender allowance *)\n    senderAccount.allowances[spender] := value;\n\n    (* Update storage *)\n    s.ledger[Tezos.sender] := senderAccount;\n\n  } with (noOperations, s)\n\n(* View function that forwards the balance of source to a contract *)\nfunction getBalance (const owner : address; const contr : contract(amt); var s : storage) : return is\n  block {\n    const ownerAccount : account = getAccount(owner, s);\n  } with (list [transaction(ownerAccount.balance, 0tz, contr)], s)\n\n(* View function that forwards the allowance amt of spender in the name of tokenOwner to a contract *)\nfunction getAllowance (const owner : address; const spender : address; const contr : contract(amt); var s : storage) : return is\n  block {\n    const ownerAccount : account = getAccount(owner, s);\n    const spenderAllowance : amt = getAllowance(ownerAccount, spender, s);\n  } with (list [transaction(spenderAllowance, 0tz, contr)], s)\n\n(* View function that forwards the totalSupply to a contract *)\nfunction getTotalSupply (const contr : contract(amt); var s : storage) : return is\n  block {\n    skip\n  } with (list [transaction(s.totalSupply, 0tz, contr)], s)\n\nfunction mint (var s : storage) : return is\n  block {\n    const senderAccount : account = getAccount(Tezos.sender, s);\n    senderAccount.balance := senderAccount.balance + Tezos.amount / 1mutez;\n    s.ledger[Tezos.sender] := senderAccount;\n  } with (noOperations, s)\n\nfunction withdraw (const value : amt; var s : storage) : return is\n  block {\n    const senderAccount : account = getAccount(Tezos.sender, s);\n    if senderAccount.balance < value then\n      failwith(\"NotEnoughBalance\")\n    else skip;\n\n    senderAccount.balance := abs(senderAccount.balance - value);\n    s.ledger[Tezos.sender] := senderAccount;\n  } with (list [Tezos.transaction(unit, value * 1mutez, (get_contract(Tezos.sender) : contract(unit)))], s)\n\n(* Main entrypoint *)\nfunction main (const action : entryAction; var s : storage) : return is\n  block {\n    skip\n  } with case action of\n    | Transfer(params) -> transfer(params.0, params.1.0, params.1.1, s)\n    | Approve(params) -> approve(params.0, params.1, s)\n    | GetBalance(params) -> getBalance(params.0, params.1, s)\n    | GetAllowance(params) -> getAllowance(params.0.0, params.0.1, params.1, s)\n    | GetTotalSupply(params) -> getTotalSupply(params.1, s)\n    | Mint -> mint(s)\n    | Withdraw(params) -> withdraw(params.0, s)\n  end;\n",
  "sourcePath": "/Users/oleh/Desktop/BasicLendingProtocol/contracts/main/XTZ.ligo",
  "compiler": {
    "name": "ligo",
    "version": "next"
  },
  "networks": {},
  "schemaVersion": "3.2.0-tezos.1",
  "updatedAt": "2021-04-14T11:52:10.357Z"
}